<tool id="rdconf" name="RDConf: Low-energy ligand conformer search" version="@TOOL_VERSION@+galaxy@GALAXY_VERSION@">
    <description>using RDKit </description>
    <macros>
        <import>macros.xml</import>
        <token name="@GALAXY_VERSION@">0</token>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[
        python '$__tool_directory__/rdconf.py'
            '$infile'
            --maxconfs '$CNT'
            --sample_multiplier '$N'
            --seed '$s'
            --rms_threshold '$R'
            --energy_window '$E'
            --mmff
            --nomin
            --etkdg
            '$outfile'                     
    ]]></command>
    <inputs>
        <param name="infile" type="data" format="smi" label="Input file" help="Input file in SMI format."/>
        <param name="CNT" type="integer"  value="20" label="Maximum number of conformers (maxconfs) to generate per molecule (default 20)."/>
        <param name="N" type="integer" value="1" label="Sample an integer multiple of the maxconf value and choose the maxconformers with lowest energy (default 1)."/>
        <param name="s" type="integer" value="9162006" label="Random seed (default 9162006)."/>
        <param name="R" type="float" value="0.7" min="0" label="RMSD threshold" help="If a conformer is too similar to those already generated (below the RMSD threshold), it is discarded and regenerated."/>
        <param name="E" type="float" value="10" label="Energy window threshold (default 10 kcal/mol)."/>
    </inputs>
    
    <expand macro="outputs" />
    
    <tests>
        <test>
            <param name="infile" value="staurosporine.smi" ftype="smi"/>
            <param name="CNT" value="100"/>
            <param name="N" value="1"/>
            <param name="s" value="100"/>
            <param name="R" value="0.7"/>
            <param name="E" value="10"/>                       
            <output name="outfile" ftype="sdf" file="rdconf_output1.sdf"/>
        </test>
    </tests>
    <help><![CDATA[

.. class:: infomark

**What this tool does**

This tool generates low-energy conformers for a set of input molecules, using the chemistry toolkit RDKit.


-----

.. class:: infomark

**Input**

| - Molecules in `SMI format`_
| - A number of other parameters can be set; the most important include the number of conformers (default 20) to generate and the minimum RMSD difference (default 0.7) between them.
.. _SMI format: https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system


-----

.. class:: infomark

 **Output**

SD-file containing generated conformers.
.. _SDF format: http://en.wikipedia.org/wiki/Chemical_table_file

]]>
    </help>
    <citations>
        <citation type="bibtex">
            @article{rdkit,
                author = {Greg Landrum and others},
                title = {RDKit: Open-source cheminformatics},
                url ={http://www.rdkit.org}
            }</citation>
                    <citation type="bibtex">
            @article{rdconf,
                author = {David Koes},
                title = {RDConf: Low-energy ligand conformer search},
                url ={https://github.com/dkoes/rdkit-scripts}
            }</citation>
    </citations>
</tool>

